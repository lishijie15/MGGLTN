## Meta Guided-Graph Lightweight TimesNet for Traffic Prediction in Vehicular Networks

### Introduction of Our Model

* To enhance prediction accuracy by effectively decoupling the temporal and spatial heterogeneity of traffic flow, we propose a novel high-performance lightweight traffic flow prediction model that can provide guidance support to CVs.
* To capture the intricate spatio-temporal features of traffic flow, we design the GCNLTimes module, which leverages GCN to extract spatial correlations and LTimes, with consideration for time-frequency domain characteristics, to extract temporal correlations.
* To decouple the spatio-temporal heterogeneity of traffic flow, we introduce a novel meta guided-graph library that selectively memorizes and queries spatial features at different time steps, thereby analyzing the time-varying node characteristics.
* To optimize computational efficiency and enhance adaptability to diverse traffic flow prediction tasks, while also providing accurate real-time data to CVs, we integrate lightweight depthwise separable convolutions into the GCNLTimes module. The proposed MGGLTN achieves state-of-the-art (SOTA) performance across various datasets.

### Experiments Results

 Our model achieves or approaches SOTA in major cases and the specific experimental results are shown in the following table.

| Datasets | MAE/RMSE/MAPE@1st step | MAE/RMSE/MAPE@3rd step | MAE/RMSE/MAPE@6th step |
| :------- | :--------------------- | :--------------------- | :--------------------- |
| METR-LA  | 2.61/5.03/6.44%                 | 3.01/6.09/7.93%        | 3.49/7.3/9.60%         |
| PEMS-BAY | 1.29/2.60/2.65%                 | 1.60/3.69/3.55%        | 1.90/4.46/4.50%        |
| EXPY-TKY | 5.84/9.24/24.77%                 | 6.44/10.35/29.10%      | 6.80/10.97/31.19%      |



### Installation and Run

#### Arguments

- **METR-LA and PEMS-BAY**

  The default hyper-parameters used in our paper are written in MGGLTN_traffic/MGGLTN_main_LABAY.py as follows.
  The ratio for train:valid:test is roughly 7:1:2, generated by generate_training_data.py. 

- **EXPY-TKY:**

  The hyper-parameters for EXPY-TKY are in MGGLTN_traffic/MGGLTN_main.py. Note EXPY-TKY data is structured by month, where '202110' and '202111' used as training and validation and '202112' used as testing. By further setting val_ratio as 0.25 (that meas 25% data of '202110' and '202111' as valid data), the ratio for train:valid:test is roughly 3:1:2. The time interval for EXPY-TKY is 10 minutes. </br>



#### Datasets

We conducted experiments on three different datasets (i.e., METR-LA, REMS-BAY, EXPY-TKY). You can find the datasets we used in the directory labeled as https://github.com/deepkashiwa20/MegaCRN.



#### Requirements

MGGLTN is compatible with PyTorch==1.11 versions.

Please code as below to install some nesessary libraries.

```
pip install -r requirements.txt
```



#### Run Our Model

To run our model, please execute the following code in the directory labeled as "MGGLTN_traffic".

```
python MGGLTN_main_LABAY.py/MGGLTN_main.py 
```


