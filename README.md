## Meta Guided-Graph Lightweight TimesNet for Traffic Prediction in Vehicular Networks

## Abstract
> *A novel model named Meta Guided-Graph Lightweight TimesNet (MGGLTN) is proposed in this study to accurately capture the spatio-temporal correlations within traffic flow data, thereby providing precise traffic flow predictions for connected vehicles (CVs). Our spatio-temporal information learning architecture features an encoder-decoder backbone, wherein both the encoder and decoder comprise Graph Convolutional Networks (GCNs) coupled with Lightweight Times modules. Innovatively, we propose a meta guided-graph library, aimed at providing memory queries for time-varying traffic patterns based on real physical-spatial information. It reasonably guides the initialization direction of meta guided-graph prototypes and avoids meaningless random meta graph information, thereby accelerating the convergence speed of model training. To enhance learning precision, the library generation modules are embedded into the encoder, and the library querying modules are embedded into the central sections of the encoder-decoder. Moreover, we introduce depthwise separable convolutions to replace the computationally intensive multi-kernel convolutions in the Times modules, thus significantly reducing computational costs and model parameters while maintaining accuracy. We perform extensive experiments on three public benchmark datasets (i.e., METR-LA, PEMS-BAY, and EXPY-TKY) and conduct comprehensive performance evaluations compared to both baseline models and state-of-the-art models. The findings demonstrate the superior performance of our model across all three datasets of varying spatial scales, highlighting the potential of this model to provide precise traffic guidance for CVs.*
> 
![image](https://github.com/lishijie15/DEFMN/blob/ba745b7380de1ae4a9ee5819471696b75e07d402/pictures/DEFMN.png)
> 
### Introduction of Our Model

* To enhance prediction accuracy by effectively decoupling the temporal and spatial heterogeneity of traffic flow, we propose a novel high-performance lightweight traffic flow prediction model that can provide guidance support to CVs.
* To capture the intricate spatio-temporal features of traffic flow, we design the GCNLTimes module, which leverages GCN to extract spatial correlations and LTimes, with consideration for time-frequency domain characteristics, to extract temporal correlations.
* To decouple the spatio-temporal heterogeneity of traffic flow, we introduce a novel meta guided-graph library that selectively memorizes and queries spatial features at different time steps, thereby analyzing the time-varying node characteristics.
* To optimize computational efficiency and enhance adaptability to diverse traffic flow prediction tasks, while also providing accurate real-time data to CVs, we integrate lightweight depthwise separable convolutions into the GCNLTimes module. The proposed MGGLTN achieves state-of-the-art (SOTA) performance across various datasets.


### Experiments Results

 Our model achieves or approaches SOTA in major cases and the specific experimental results are shown in the following table.

| Datasets | MAE/RMSE/MAPE@1st step | MAE/RMSE/MAPE@3rd step | MAE/RMSE/MAPE@6th step |
| :------- | :--------------------- | :--------------------- | :--------------------- |
| METR-LA  | 2.61/5.03/6.44%                 | 3.01/6.09/7.93%        | 3.49/7.3/9.60%         |
| PEMS-BAY | 1.29/2.60/2.65%                 | 1.60/3.69/3.55%        | 1.90/4.46/4.50%        |
| EXPY-TKY | 5.84/9.24/24.77%                 | 6.44/10.35/29.10%      | 6.80/10.97/31.19%      |



### Installation and Run

#### Arguments

- **METR-LA and PEMS-BAY**

  The default hyper-parameters used in our paper are written in MGGLTN_traffic/MGGLTN_main_LABAY.py as follows.
  The ratio for train:valid:test is roughly 7:1:2, generated by generate_training_data.py. 

- **EXPY-TKY:**

  The hyper-parameters for EXPY-TKY are in MGGLTN_traffic/MGGLTN_main.py. Note EXPY-TKY data is structured by month, where '202110' and '202111' used as training and validation and '202112' used as testing. By further setting val_ratio as 0.25 (that meas 25% data of '202110' and '202111' as valid data), the ratio for train:valid:test is roughly 3:1:2. The time interval for EXPY-TKY is 10 minutes. </br>



#### Datasets

We conducted experiments on three different datasets (i.e., METR-LA, REMS-BAY, EXPY-TKY). You can find the datasets we used in the directory labeled as https://github.com/deepkashiwa20/MegaCRN.



#### Requirements

MGGLTN is compatible with PyTorch==1.11 versions.

Please code as below to install some nesessary libraries.

```
pip install -r requirements.txt
```


#### Run Our Model

To run our model, please execute the following code in the directory labeled as "MGGLTN_traffic".

```
python MGGLTN_main_LABAY.py/MGGLTN_main.py 
```


